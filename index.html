<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Prochains RER A à Joinville</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-indigo-100 to-white min-h-screen p-3">
  <div class="max-w-3xl mx-auto">
    <h1 class="text-3xl font-extrabold text-center mb-1">Prochains RER A à Joinville-le-Pont</h1>
    <p class="text-center text-gray-500 mb-8">Données temps réel (GTFS export auto)</p>
    <div id="rer-directions" class="flex flex-col md:flex-row gap-6"></div>
  </div>

  <script>
  async function main() {
    const resp = await fetch('static/rer_a_prochains_trains_by_direction.json');
    const data = await resp.json();

    const root = document.getElementById('rer-directions');
    root.innerHTML = "";

    for (const [direction, trains] of Object.entries(data)) {
      const col = document.createElement('div');
      col.className = "flex-1 bg-white rounded-2xl shadow-md p-4 min-w-[250px]";

      // Titre direction
      const title = document.createElement('div');
      title.className = "font-bold text-xl mb-4 text-indigo-800 flex items-center gap-2";
      title.innerHTML = `<span class="inline-block w-3 h-3 bg-indigo-400 rounded-full"></span> ${direction}`;
      col.appendChild(title);

      // Trains
      for (const train of trains) {
        const trainDiv = document.createElement('div');
        trainDiv.className = "mb-4 p-3 border border-indigo-100 rounded-xl hover:shadow transition";

        trainDiv.innerHTML = `
          <div class="flex items-baseline justify-between">
            <span class="font-semibold text-lg text-indigo-700">${train.heure}</span>
            <span class="text-xs bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded">${train.mission}</span>
          </div>
          <div class="text-sm text-gray-600">${train.destination}</div>
          <details class="mt-2 text-xs group">
            <summary class="cursor-pointer text-indigo-600 hover:underline mb-1">Gares restantes&nbsp;<span class="text-gray-400">(voir)</span></summary>
            <ul class="ml-4 list-disc marker:text-indigo-400 marker:font-bold">
              ${train.gares_restantes.map(stop => `<li>${stop}</li>`).join("")}
            </ul>
          </details>
        `;
        col.appendChild(trainDiv);
      }

      root.appendChild(col);
    }
  }

  main();
  </script>
</body>
</html>
